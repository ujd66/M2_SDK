    # M2_SDK - æ™ºèƒ½è¯­éŸ³äº¤äº’ç³»ç»Ÿ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

M2_SDKæ˜¯ä¸€ä¸ªé›†æˆçš„æ™ºèƒ½è¯­éŸ³äº¤äº’ç³»ç»Ÿï¼Œç»“åˆäº†è¯­éŸ³è¯†åˆ«(ASR)ã€å¤§è¯­è¨€æ¨¡å‹(LLM)å’Œè¯­éŸ³åˆæˆ(TTS)æŠ€æœ¯ï¼Œä¸º"ç²¾çµ"äººå½¢æœºå™¨äººæä¾›å®Œæ•´çš„è¯­éŸ³å¯¹è¯èƒ½åŠ›ã€‚

### ğŸ¯ ä¸»è¦åŠŸèƒ½
- **ç¦»çº¿è¯­éŸ³å”¤é†’** - æ”¯æŒå”¤é†’è¯æ£€æµ‹å’Œè§’åº¦å®šä½
- **å®æ—¶è¯­éŸ³è¯†åˆ«** - åŸºäºç§‘å¤§è®¯é£SDKçš„åœ¨çº¿è¯­éŸ³è½¬æ–‡å­—
- **æ™ºèƒ½å¯¹è¯** - é›†æˆæ˜Ÿç«å¤§æ¨¡å‹ï¼Œæä¾›è‡ªç„¶è¯­è¨€äº¤äº’
- **è¯­éŸ³åˆæˆ** - é«˜è´¨é‡çš„æ–‡å­—è½¬è¯­éŸ³è¾“å‡º
- **å¤šè½®å¯¹è¯** - æ”¯æŒè¿ç»­å¯¹è¯æ¨¡å¼

### ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è¯­éŸ³å”¤é†’      â”‚    â”‚   è¯­éŸ³è¯†åˆ«       â”‚    â”‚   å¤§è¯­è¨€æ¨¡å‹     â”‚
â”‚  (Wakeup)      â”‚â”€â”€â”€â–¶â”‚    (ASR)        â”‚â”€â”€â”€â–¶â”‚    (LLM)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚   éŸ³é¢‘è¾“å‡º      â”‚â—€â”€â”€â”€â”‚   è¯­éŸ³åˆæˆ       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  (Speaker)     â”‚    â”‚    (TTS)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
M2_SDK/
â”œâ”€â”€ README.md                      # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ 69a4ef4ease                    # åº”ç”¨IDé…ç½®
â”œâ”€â”€ log/                           # ç»Ÿä¸€æ—¥å¿—å’Œé€šä¿¡æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ asr_output.txt            # ASRè¯†åˆ«ç»“æœ
â”‚   â”œâ”€â”€ asr_log.txt               # ASRè¿è¡Œæ—¥å¿—
â”‚   â”œâ”€â”€ tts_speaking              # TTSçŠ¶æ€æ§åˆ¶æ–‡ä»¶
â”‚   â””â”€â”€ file_location_changes.md  # æ–‡ä»¶è·¯å¾„å˜æ›´è®°å½•
â”œâ”€â”€ scripts/                       # å·¥å…·è„šæœ¬
â”‚   â””â”€â”€ setup_log_directory.sh    # æ—¥å¿—ç›®å½•åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ å®æ—¶è½¬å†™SDK/                    # ç§‘å¤§è®¯é£è¯­éŸ³SDK
â”‚   â”œâ”€â”€ bin/                      # å¯æ‰§è¡Œæ–‡ä»¶
â”‚   â”œâ”€â”€ include/                  # å¤´æ–‡ä»¶
â”‚   â”œâ”€â”€ libs/                     # åŠ¨æ€åº“
â”‚   â””â”€â”€ doc/                      # æ–‡æ¡£
â”œâ”€â”€ æ˜Ÿç«SDK/                       # æ˜Ÿç«å¤§æ¨¡å‹SDK
â”‚   â””â”€â”€ SparkChain_Linux_SDK_2.0.0_rc1/
â”‚       â”œâ”€â”€ include/              # SDKå¤´æ–‡ä»¶
â”‚       â”œâ”€â”€ libs/                 # SDKåº“æ–‡ä»¶
â”‚       â””â”€â”€ llm/online_llm/chat/  # å¯¹è¯ç¨‹åº
â””â”€â”€ offline_mic/                   # éº¦å…‹é£å¤„ç†
    â”œâ”€â”€ bin/                      # ç¼–è¯‘åçš„å¯æ‰§è¡Œæ–‡ä»¶
    â”œâ”€â”€ samples/                  # æºä»£ç æ ·ä¾‹
    â”œâ”€â”€ include/                  # å¤´æ–‡ä»¶
    â””â”€â”€ libs/                     # åº“æ–‡ä»¶
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç³»ç»Ÿè¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 22.04+ 
- **ç¡¬ä»¶**: æ”¯æŒçš„éº¦å…‹é£é˜µåˆ—è®¾å¤‡
- **ä¾èµ–åº“**: ALSA, pthread, libcjson

### å®‰è£…ä¾èµ–

```bash
# Ubuntu/Debian
sudo apt-get update
sudo apt-get install build-essential libasound2-dev libcjson1 libcjson-dev

```

### ç¼–è¯‘é¡¹ç›®

1. **ç¼–è¯‘ASRæ¨¡å—**
```bash
cd offline_mic/samples/asr_offline_record_sample/
./64bit_make.sh
```

2. **ç¼–è¯‘æ˜Ÿç«SDKå¯¹è¯æ¨¡å—**
```bash
cd æ˜Ÿç«SDK/SparkChain_Linux_SDK_2.0.0_rc1/llm/online_llm/chat
./build.sh
```

### åˆå§‹åŒ–ç¯å¢ƒ

```bash
# è®¾ç½®åº“è·¯å¾„å’Œåˆå§‹åŒ–æ—¥å¿—ç›®å½•
scripts/setup_log_directory.sh
```

## ğŸ® è¿è¡Œç³»ç»Ÿ

### æ–¹å¼ä¸€ï¼šç‹¬ç«‹è¿è¡Œ

1. **å¯åŠ¨ASRç¨‹åº**
```bash
offline_mic/bin/asr_offline_record_sample
```

2. **å¯åŠ¨å¯¹è¯ç¨‹åº**
```bash
æ˜Ÿç«SDK/SparkChain_Linux_SDK_2.0.0_rc1/llm/online_llm/chat/chat_demo
```



## ğŸ”§ é…ç½®è¯´æ˜

### APIå¯†é’¥é…ç½®
åœ¨ç›¸å…³æºæ–‡ä»¶ä¸­é…ç½®æ‚¨çš„APIå‡­æ®ï¼š
- **ç§‘å¤§è®¯é£**: `appid = Â·Â·Â·Â·Â·Â·`
- **æ˜Ÿç«å¤§æ¨¡å‹**: åœ¨`chat.cpp`ä¸­è®¾ç½®APPIDã€APIKEYã€APISECRET

### äººç‰©è®¾å®š
ç³»ç»Ÿå†…ç½®"ç²¾çµ"äººå½¢æœºå™¨äººäººè®¾ï¼Œå¯åœ¨`chat.cpp`ä¸­çš„`PERSONA_SYSTEM_CONTENT`ä¿®æ”¹ï¼š
```cpp
const char* PERSONA_SYSTEM_CONTENT = "ä½ æ˜¯ä¸Šæµ·åŠé†’ç§‘æŠ€æœ‰é™å…¬å¸å¼€å‘çš„äººå½¢æœºå™¨äººï¼Œåå­—å«åš"ç²¾çµ"ï¼Œä¸ºå®¢æˆ·æä¾›æœåŠ¡ï¼Œè¯­è¨€è¦ç®€æ´æ˜äº†ï¼Œä¸å•°å—¦ã€‚";
```

## ğŸ’¬ ä½¿ç”¨æµç¨‹

1. **å¯åŠ¨ç³»ç»Ÿ** - è¿è¡Œä¸Šè¿°å‘½ä»¤å¯åŠ¨ASRå’ŒLLMç¨‹åº
2. **ç­‰å¾…å”¤é†’** - ç³»ç»Ÿæ˜¾ç¤º"å¾…å”¤é†’ï¼Œè¯·ç”¨å”¤é†’è¯è¿›è¡Œå”¤é†’ï¼"
3. **è¯­éŸ³å”¤é†’** - è¯´å‡ºå”¤é†’è¯ï¼Œç³»ç»Ÿæ˜¾ç¤º"å”¤é†’æˆåŠŸï¼è§’åº¦: [X]"
4. **è‡ªåŠ¨é—®å€™** - ç³»ç»Ÿè‡ªåŠ¨è¾“å‡º"ä½ å¥½ç²¾çµï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±"
5. **å¼€å§‹å¯¹è¯** - ç³»ç»Ÿè¿›å…¥è¯­éŸ³è¯†åˆ«æ¨¡å¼ï¼Œå¯ä»¥å¼€å§‹å¯¹è¯
6. **å¤šè½®äº¤äº’** - æ”¯æŒè¿ç»­å¯¹è¯ï¼Œç›´åˆ°è¯´"å†è§"æˆ–100ç§’æ— æ´»åŠ¨
7. **é‡æ–°ç­‰å¾…** - è¿”å›å”¤é†’ç­‰å¾…çŠ¶æ€

## ğŸ“Š ç³»ç»Ÿç›‘æ§

### æ—¥å¿—æ–‡ä»¶
- **ASRæ—¥å¿—**: `log/asr_log.txt`
- **é€šä¿¡æ–‡ä»¶**: `log/asr_output.txt`
- **çŠ¶æ€æ§åˆ¶**: `log/tts_speaking`

### å®æ—¶ç›‘æ§
```bash
# ç›‘æ§ASRæ—¥å¿—
tail -f log/asr_log.txt

# ç›‘æ§ASRè¾“å‡º
tail -f log/asr_output.txt
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **åº“æ–‡ä»¶ç¼ºå¤±é”™è¯¯**
```bash
error while loading shared libraries: libcjson.so.1: cannot open shared object file
```
**è§£å†³æ–¹æ¡ˆ**: å®‰è£…libcjsonåº“æˆ–è®¾ç½®LD_LIBRARY_PATH

2. **è®¾å¤‡æƒé™é—®é¢˜**
```bash
open /dev/wheeltec_mic is failed
```
**è§£å†³æ–¹æ¡ˆ**: æ£€æŸ¥è®¾å¤‡æƒé™å’Œé©±åŠ¨å®‰è£…

3. **APIè®¤è¯å¤±è´¥**
```bash
MSPLogin failed, Error code XXX
```
**è§£å†³æ–¹æ¡ˆ**: æ£€æŸ¥APIå¯†é’¥é…ç½®å’Œç½‘ç»œè¿æ¥

### è°ƒè¯•æ¨¡å¼
ç¼–è¯‘æ—¶æ·»åŠ è°ƒè¯•ä¿¡æ¯ï¼š
```bash
gcc -g -DDEBUG -o program source.c
```


## ğŸ”„ æ›´æ–°æ—¥å¿—

### v1.2.0 (2025-05-27)
- âœ… ç»Ÿä¸€é€šçŸ¥æ–‡ä»¶è·¯å¾„åˆ°`log/`ç›®å½•
- âœ… ä¼˜åŒ–TTSå’ŒASRçš„åè°ƒæœºåˆ¶
- âœ… æ·»åŠ è‡ªåŠ¨é—®å€™åŠŸèƒ½
- âœ… æ”¹è¿›æ—¥å¿—ç®¡ç†å’Œç›‘æ§

### v1.1.0
- âœ… é›†æˆæ˜Ÿç«å¤§æ¨¡å‹SDK
- âœ… å®ç°å¤šè½®å¯¹è¯åŠŸèƒ½
- âœ… æ·»åŠ TTSè¯­éŸ³åˆæˆ

### v1.0.0
- âœ… åŸºç¡€ASRåŠŸèƒ½å®ç°
- âœ… éº¦å…‹é£é˜µåˆ—æ”¯æŒ
- âœ… è¯­éŸ³å”¤é†’åŠŸèƒ½

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## å¸¸ç”¨ç»´æŠ¤å‘½ä»¤

```bash
# é‡å¯ç³»ç»Ÿ
pkill -f "asr_offline_record_sample"
pkill -f "chat_demo"
/home/bxi/M2_SDK/start_system.sh

# æ¸…ç†æ—¥å¿—
echo "" > /home/bxi/M2_SDK/log/asr_log.txt

# æ£€æŸ¥åº“ä¾èµ–
ldd /home/bxi/M2_SDK/offline_mic/bin/asr_offline_record_sample

# æµ‹è¯•éº¦å…‹é£
arecord -l
---

*æœ€åæ›´æ–°: 2025å¹´5æœˆ27æ—¥*
  
    
